<script type="text/javascipt">
	//dojo.require("dojox.widget.FisheyeLite");
	//dojo.require("dojo.fx");
	dojo.require("dijit.layout.LayoutContainer");
	dojo.require("dojo.colors");
	dojo.require("dojox.gfx");
	dojo.require("dojox.gfx.matrix");
	dojo.require("dojox.gfx.move");
	//dojo.require("dojo.data.ItemFileReadStore");
	dojo.require("dojo.data.ItemFileWriteStore");
	dojo.require("dijit.Menu");
</script>

<div dojoType="dojox.layout.FloatingPane" resizable="true" style="width:150px; height:350px; top:10%; left:80%; position:absolute; z-index:50000;" title="Details" closable="false" dockable="false" id="supervisorDetails">
	<p style="padding:12px">nocontent</p>
</div> 

<div dojoType="dijit.Menu" id="agentAction" style="display:none">
	<div dojoType="dijit.MenuItem">Released
		<script type="dojo/method" event="onClick">
			geturl = "/supervisor/agentstate/" + escape(dijit.byId("agentAction").agentBubbleHit) + "/released/default";
			dojo.xhrGet({
				url:geturl,
				handleAs: "json",
				load: function(resp){
					if(resp.success){
						return true;
					}
					
					console.log(resp.message);
				}
			})
		</script>
	</div>
	<div dojoType="dijit.MenuItem">Idle
		<script type="dojo/method" event="onClick">
			var geturl = "/supervisor/agentstate/" + escape(dijit.byId("agentAction").agentBubbleHit) + "/idle";
			dojo.xhrGet({
				url:geturl,
				handleAs: "json",
				load: function(resp){
					if(resp.success){
						return true;
					}
					console.log(resp.message);
				}
			});
		</script>
	</div>
	<div dojoType="dijit.MenuSeparator"></div>
	<div dojoType="dijit.MenuItem">Blab
		<script type="dojo/method" event="onClick">
			var dialog = new dijit.Dialog({
				title: "Blab",
				content: '<p><textarea name="message" dojoType="dijit.form.SimpleTextarea">Type your message here.</textarea></p><p><input type="submit" dojoType="dijit.form.Button" label="Submit" /></p>',
				execute: function(){
					alert(["goober!", arguments]);
				}
			});
			var submitblab = function(){
				var data = dialog.attr('value');
				dojo.xhrPost({
					handleAs:"json",
					url:"/supervisor/blab",
					content:{
						message:data.message,
						type: "agent",
						value: escape(dijit.byId("agentAction").agentBubbleHit)
					},
					load:function(res){
						debug(["blab worked", res])
					},
					error:function(res){
						warning(["blab failed", res])
					}
				})
			}
			dialog.attr('execute', submitblab);
			dialog.show();
		</script>
	</div>
	<div dojoType="dijit.MenuSeparator"></div>
	<div dojoType="dijit.MenuItem">Kick
		<script type="dojo/method" event="onClick">
			var geturl = "/supervisor/kick_agent/" + escape(dijit.byId("agentAction").agentBubbleHit);
			dojo.xhrGet({
				url:geturl,
				handleAs: "json",
				load:function(resp){
					if(resp.success){
						return true;
					}
					else{
						console.log(resp.message);
					}
				}
			});
		</script>
	</div>
</div>

<div dojoType="dijit.layout.ContentPane" id="supervisorMain">
	<div id="supervisorMonitor" style="border: black"></div>
</div>

<script type="text/javascript" src="tabs/supervisor.js"></script>
