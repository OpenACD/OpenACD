<script type="text/javascipt">
	dojo.require("dojox.widget.FisheyeLite");
	dojo.require("dojo.fx");
	dojo.require("dijit.layout.LayoutContainer");
</script>

<div dojoType="dijit.layout.ContentPane" id="supervisorMain">
	<script type="dojo/method" event="postCreate">
		dojo.query("#nodeDisp >").forEach(function(n){
			new dojox.widget.FisheyeLite({
				properties: {
					height: 2,
					width: 3
				},
				easeOut: dojo.fx.easing.quadInOut,
				durationOut: 500
			}, n);
		}).connect("onclick", function(e){
			//meh
		});
	</script>
	<style type="text/css">
		#nodeDisp {
			text-align:center;
			overflow:visible
		}
		span.nodeTarg {
			margin:10px;
			padding:3px;
			line-height:22px;
			font:10px Arial,sans-serif;
			height: 50px;
			width: 50px;
			background-color:black;
			display:inline-block
		}
	</style>

	<div id="agentDisp" dojoType="dijit.layout.LayoutContainer">
		<script type="dojo/method" event="postCreate">
			console.log('todo');
		</script>
	</div>
	
	<div id="queueDisp" dojoType="dijit.layout.LayoutContainer">
		<script type="dojo/method" event="postCreate">
			console.log('todo');
		</script>
	</div>

	<div id="nodeDisp" dojoType="dijit.layout.LayoutContainer">
		<script type="dojo/method" event="postCreate">
			var t = this;
			this.nodeSubscription = dojo.subscribe("supervisor/node/poll", function(names){
				names.push("all");
				t.destroyDescendants();
				dojo.forEach(names, function(name){
					var whenclicked = function(e){
						supervisorTab.pollAgentProfiles(name);
						supervisorTab.pollQueues(name);
					};
					var actor = document.createElement('span');
					actor.style.backgroundColor = 'green';
					actor.style.display = 'inline-block';
					actor.style.margin = '5px';
					actor.style.width = '100px';
					actor.style.height = '50px';
					actor.innerHTML = name;
					var f = new dojox.widget.FisheyeLite({
						properties: {
							height: 2,
							width: 3
						},
						easeOut: dojo.fx.easing.quadInOut,
						durationOut: 500,
						onClick: whenclicked
					}, actor);
					t.addChild(f);
				});
			});
			supervisorTab.pollNodes();
		</script>
	</div>
</div>

<script type="text/javascript" src="tabs/supervisor.js"></script>
